<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
          content="Greenova Feedback System for tracking and managing environmental compliance feedback." />
    <meta name="keywords"
          content="Greenova, Feedback, Environmental Management, Compliance, Bug Reports" />
    <title>
      {% block title %}
        Greenova Feedback
      {% endblock title %}
    </title>
    {{ django_htmx_script() }}
  </head>
  <body hx-ext="path-deps,loading-states,head-support,class-tools">
    <header>
      <h1>Greenova Feedback System</h1>
      <nav>
        <ul>
          <li>
            <a href="{{ url('dashboard:home') }}">Back to Dashboard</a>
          </li>
        </ul>
      </nav>
    </header>
    <main class="container">
      {% if messages %}
        <div class="messages">
          <ul>
            {% for message in messages %}<li>{{ message|safe }}</li>{% endfor %}
          </ul>
        </div>
      {% endif %}
      {% block content %}
        <!-- Using filters -->
        <span class="badge {{ report.severity|severity_color }}">{{ report.get_severity_display() }}</span>
        <span class="status-indicator {{ report.status|status_color }}">{{ report.get_status_display() }}</span>
        <!-- Using globals -->
        <div class="bug-tracker-summary">
          <h3>Open Bug Reports: {{ get_open_bug_count() }}</h3>
        </div>
        <!-- Using the mini tracker -->
        {% set bug_tracker = show_bug_tracker_mini() %}
        <div class="mini-tracker">
          <h4>Latest Issues ({{ bug_tracker.count }})</h4>
          <ul>
            {% for bug in bug_tracker.bug_reports %}
              <li>
                {{ bug.title }} <span class="badge {{ bug.severity|severity_color }}">{{ bug.get_severity_display() }}</span>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endblock content %}
    </main>
    <script src="{{ static('js/vendor/htmx.min.js') }}" defer></script>
    <script src="{{ static('js/vendor/htmx/ext/path-deps.min.js') }}" defer></script>
    <script src="{{ static('js/vendor/htmx/ext/loading-states.min.js') }}" defer></script>
    <script src="{{ static('js/vendor/htmx/ext/head-support.min.js') }}" defer></script>
    <script src="{{ static('js/vendor/htmx/ext/class-tools.min.js') }}" defer></script>
    <script src="{{ static('js/vendor/_hyperscript.min.js') }}" defer></script>
    <footer>
      <p>Greenova Environmental Management System - Feedback Module</p>
    </footer>
  </body>
</html>
